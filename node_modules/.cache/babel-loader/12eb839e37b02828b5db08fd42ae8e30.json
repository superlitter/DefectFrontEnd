{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport store from '../store';\nimport BugContentVue from './BugContent.vue';\nexport default {\n  name: 'side-bar',\n\n  data() {\n    const data = [];\n    return {\n      data: [],\n      options: [],\n      vm: this,\n      value: '',\n      // data: JSON.parse(JSON.stringify(data)),\n      // data: JSON.parse(JSON.stringify(data)),\n      dialogTableVisible: false,\n      dialogFormVisible: false,\n      nodeData: [],\n      form: {\n        moduleName: \"\",\n        moduleRemark: \"\"\n      },\n      insertLevelTwoFormVisible: false,\n      updateLevelOneFormVisible: false,\n      updateLevelTwoFormVisible: false,\n      formLabelWidth: '80px'\n    };\n  },\n\n  created() {\n    console.log(\"侧边栏 create函数执行了\");\n    this.$forceUpdate(); // 此时可以获取到data中的变量值\n\n    var numme = null;\n    this.postRequest(`/projects/selectAll`, numme).then(resp => {\n      // console.log(resp);\n      // console.log(this.options);\n      // console.log(resp);\n      this.options = resp.data;\n      this.update(); // console.log(this.options);\n    });\n  },\n\n  methods: {\n    onProChange(val) {\n      // console.log(val);\n      store.commit(\"editProjectName\", val);\n      console.log(\"store.state.projectName 值为 \" + store.state.projectName); // this.update();\n\n      var _this = this; //Edit\n\n\n      this.getRequest(`/modules/selectByProjectNameList`, {\n        params: {\n          ProjectName: store.state.projectName\n        }\n      }).then(resp => {\n        console.log(\"In get List function\"); // console.log(resp.data);\n\n        this.data = resp.data;\n        store.commit(\"editModules\", resp.data);\n        console.log(\"store.state.modules 值为 \");\n        console.log(store.state.modules);\n        console.log(resp.data);\n        console.log(\"|_________________|\");\n\n        _this.update();\n      });\n    },\n\n    // 插入一级模块\n    insertLevelOne(form) {\n      var para = {\n        \"moduleName\": form.moduleName,\n        \"projectName\": store.state.projectName,\n        \"moduleLevel\": \"一级\",\n        \"moduleRemark\": form.moduleRemark\n      };\n      console.log(\"In insertLevelOne para:\");\n      console.log(para);\n\n      if (store.state.projectName === 'No choose') {\n        this.$message.error('错了哦,请先选择项目捏');\n        return;\n      }\n\n      if (form.moduleName === '') {\n        this.$message.error('错了哦,请不要提交空值捏');\n        return;\n      }\n\n      var _this = this;\n\n      this.postRequest(\"/modules/insertModule/\", para).then(resp => {\n        _this.update();\n      });\n      this.formClear();\n      this.dialogFormVisible = false;\n    },\n\n    // 插入二级模块\n    insertLevelTwo(form) {\n      //   console.log(form);\n      //   console.log(this.nodeData);\n      var para = {\n        \"moduleName\": form.moduleName,\n        \"projectName\": store.state.projectName,\n        \"moduleFather\": this.nodeData.id,\n        \"moduleLevel\": \"二级\",\n        \"moduleRemark\": form.moduleRemark\n      };\n\n      if (store.state.projectName === 'No choose') {\n        this.$message.error('错了哦,请先选择项目捏');\n        return;\n      }\n\n      if (form.moduleName === '') {\n        this.$message.error('错了哦,请不要提交空值捏');\n        return;\n      }\n\n      var _this = this;\n\n      this.postRequest(\"/modules/insertModule/\", para).then(resp => {\n        _this.update();\n      });\n      this.formClear();\n      this.insertLevelTwoFormVisible = false;\n    },\n\n    // 更新一级模块模块\n    updateLevelOneModule(form) {\n      // console.log(this.nodeData)\n      var para = {\n        \"moduleId\": this.nodeData.id,\n        \"moduleName\": form.moduleName,\n        \"projectName\": store.state.projectName,\n        // \"moduleFather\" : this.nodeData.id,\n        \"moduleLevel\": \"一级\",\n        \"moduleRemark\": form.moduleRemark\n      };\n      console.log(para);\n\n      if (store.state.projectName === 'No choose') {\n        this.$message.error('错了哦,请先选择项目捏');\n        return;\n      }\n\n      if (form.moduleName === '') {\n        this.$message.error('错了哦,请不要提交空值捏');\n        return;\n      }\n\n      this.postRequest(`/modules/updateById`, para).then(resp => {\n        // console.log(\"In updateById\");\n        // console.log(resp.data);\n        this.data = resp.data;\n        this.update();\n      });\n      this.formClear();\n      this.updateLevelOneFormVisible = false;\n    },\n\n    // 更新二级模块模块\n    updateLevelTwoModule(form) {\n      // console.log(this.nodeData)\n      var para = {\n        \"moduleId\": this.nodeData.id,\n        \"moduleName\": form.moduleName,\n        \"projectName\": store.state.projectName,\n        // \"moduleFather\" : this.nodeData.id,\n        \"moduleLevel\": \"二级\",\n        \"moduleRemark\": form.moduleRemark\n      };\n      console.log(para);\n\n      if (store.state.projectName === 'No choose') {\n        this.$message.error('错了哦,请先选择项目捏');\n        return;\n      }\n\n      if (form.moduleName === '') {\n        this.$message.error('错了哦,请不要提交空值捏');\n        return;\n      }\n\n      this.postRequest(`/modules/updateById`, para).then(resp => {\n        // console.log(\"In updateById\");\n        // console.log(resp.data);\n        this.data = resp.data;\n        this.update();\n      });\n      this.formClear();\n      this.updateLevelTwoFormVisible = false;\n    },\n\n    formClear() {\n      this.form.moduleName = \"\";\n      this.form.moduleRemark = \"\";\n    },\n\n    // 此方法已弃用\n    open() {\n      console.log(\"此方法已弃用\");\n      this.$prompt('请输入问题名称', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        //   inputPattern: /$/,\n        inputErrorMessage: '名称不能为空'\n      }).then(({\n        value\n      }) => {\n        console.log(value);\n        var pn = store.state.projectName;\n        var para = {\n          \"moduleName\": value,\n          \"projectName\": pn,\n          \"moduleLevel\": \"一级\",\n          \"moduleRemark\": \"ooo\"\n        };\n\n        var _this = this;\n\n        this.postRequest(\"/modules/insertModule/\", para).then(resp => {\n          _this.update();\n        });\n        this.$message({\n          type: 'success',\n          message: '问题为 ' + value\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '取消输入'\n        });\n      });\n    },\n\n    // 此方法已弃用\n    open2(data) {\n      console.log(\"此方法已弃用\");\n      this.$prompt('请输入问题名称', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        //   inputPattern: /$/,\n        inputErrorMessage: '名称不能为空'\n      }).then(({\n        value\n      }) => {\n        console.log(value);\n        var pn = store.state.projectName;\n        console.log(\"IN OPEN2\");\n        console.log(data);\n        var temp = data.id;\n        var para = {\n          \"moduleName\": value,\n          \"projectName\": pn,\n          \"moduleFather\": temp,\n          \"moduleLevel\": \"二级\",\n          \"moduleRemark\": \"ooo\"\n        };\n\n        var _this = this;\n\n        this.postRequest(\"/modules/insertModule/\", para).then(resp => {\n          _this.update();\n        });\n        this.$message({\n          type: 'success',\n          message: '问题为 ' + value\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '取消输入'\n        });\n      });\n    },\n\n    // 删除一级或者二级模块\n    remove(node, data) {\n      var para = {\n        'moduleId': data.id\n      };\n      console.log(para);\n\n      var _this = this;\n\n      this.deleteRequest(`/modules/deleteById`, {\n        params: para\n      }).then(resp => {\n        console.log(\"In delete\");\n\n        _this.update();\n      });\n      this.formClear();\n    },\n\n    update() {\n      // 根据VueX中的projectName数据修改侧边栏树状视图\n      var val = store.state.projectName;\n      var params = {\n        'ProjectName': val\n      };\n      this.getRequest(`/modules/selectByProjectName`, {\n        params\n      }).then(resp => {\n        console.log(\"In update function\"); // console.log(resp.data);\n\n        this.data = resp.data;\n      });\n    },\n\n    renderContent(h, {\n      node,\n      data,\n      store\n    }) {\n      //console.log(\"IN renderContent\");\n      //console.log(node);\n      if (data.parentId != -1) {\n        //当父亲节点不为-1时说明不是一级节点不可以新增\n        return h(\"span\", {\n          \"class\": \"custom-tree-node\"\n        }, [h(\"span\", [node.label]), h(\"span\", [h(\"el-button\", {\n          \"attrs\": {\n            \"size\": \"huge\",\n            \"type\": \"text\",\n            \"icon\": 'el-icon-edit'\n          },\n          \"style\": \"padding-right : 5px\",\n          \"on\": {\n            \"click\": () => {\n              this.updateLevelTwoFormVisible = true;\n              this.nodeData = data;\n            }\n          }\n        }), h(\"el-popconfirm\", {\n          \"attrs\": {\n            \"confirm-button-text\": '好的',\n            \"cancel-button-text\": '不用了',\n            \"icon\": \"el-icon-info\",\n            \"icon-color\": \"red\",\n            \"title\": \"您确定删除这个节点吗？\"\n          },\n          \"on\": {\n            \"confirm\": () => this.remove(node, data)\n          }\n        }, [h(\"el-button\", {\n          \"attrs\": {\n            \"size\": \"huge\",\n            \"type\": \"text\",\n            \"icon\": 'el-icon-delete'\n          },\n          \"slot\": \"reference\"\n        })])])]);\n      } else {\n        //剩余的为一级节点可以更新\n        return h(\"span\", {\n          \"class\": \"custom-tree-node\"\n        }, [h(\"span\", [node.label]), h(\"span\", [h(\"el-button\", {\n          \"attrs\": {\n            \"size\": \"huge\",\n            \"type\": \"text\",\n            \"icon\": 'el-icon-circle-plus-outline'\n          },\n          \"on\": {\n            \"click\": () => {\n              this.insertLevelTwoFormVisible = true;\n              this.nodeData = data;\n            }\n          }\n        }), h(\"el-button\", {\n          \"attrs\": {\n            \"size\": \"huge\",\n            \"type\": \"text\",\n            \"icon\": 'el-icon-edit'\n          },\n          \"style\": \"padding-right : 5px\",\n          \"on\": {\n            \"click\": () => {\n              this.updateLevelOneFormVisible = true;\n              this.nodeData = data;\n            }\n          }\n        }), h(\"el-popconfirm\", {\n          \"attrs\": {\n            \"confirm-button-text\": '好的',\n            \"cancel-button-text\": '不用了',\n            \"icon\": \"el-icon-info\",\n            \"icon-color\": \"red\",\n            \"title\": \"您确定删除这个节点吗？\"\n          },\n          \"on\": {\n            \"confirm\": () => this.remove(node, data)\n          }\n        }, [h(\"el-button\", {\n          \"attrs\": {\n            \"size\": \"huge\",\n            \"type\": \"text\",\n            \"icon\": 'el-icon-delete'\n          },\n          \"slot\": \"reference\"\n        })])])]);\n      }\n    },\n\n    pop() {\n      console.log(1);\n    },\n\n    nodeClick(data, node, com) {\n      // console.log(\"In node click\");\n      // console.log(data);\n      // console.log(node);\n      // console.log(com);\n      //console.log(data.id);\n      // BugContentVue.methods.receive(data.id);\n      // store.commit('editModuleId', val);\n      console.log(\"In NodeClick\");\n      store.commit(\"editModuleId\", data.id);\n    }\n\n  } //   getParentId(data){\n  //     // console.log(this.$refs.tree.getCheckedKeys());//当前选择节点\n  //     // console.log(this.$refs.tree.getHalfCheckedKeys());//父节点\n  //     // return[console.log(this.$refs.tree.getHalfCheckedKeys())]\n  //     return[data.parentID]\n  //   },\n  //   computed: {\n  //     changeButton: function(){\n  //       let buttonStatus = false;\n  //       if (getParentId==-1){\n  //           buttonStatus = true\n  //       }else {\n  //           buttonStatus = false\n  //       }\n  //       return buttonStatus;\n  //     }\n  //   },\n\n};","map":{"version":3,"mappings":"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","names":["name","data","options","vm","value","dialogTableVisible","dialogFormVisible","nodeData","form","moduleName","moduleRemark","insertLevelTwoFormVisible","updateLevelOneFormVisible","updateLevelTwoFormVisible","formLabelWidth","created","console","methods","onProChange","store","params","ProjectName","then","resp","_this","insertLevelOne","insertLevelTwo","updateLevelOneModule","updateLevelTwoModule","formClear","open","confirmButtonText","cancelButtonText","inputErrorMessage","type","message","catch","open2","remove","update","renderContent","node","pop","nodeClick"],"sourceRoot":"src/components","sources":["SideBar.vue"],"sourcesContent":["<template>\r\n  <div >\r\n    <div>\r\n      <el-select\r\n          @change=\"onProChange\" v-model=\"value\" filterable placeholder=\"请选择\">\r\n        <el-option\r\n            v-for=\"item in options\"\r\n            :key=\"item.projectName\"\r\n            :label=\"item.projectName\"\r\n            :value=\"item.projectName\"\r\n        >\r\n        </el-option>\r\n      </el-select>\r\n    </div>\r\n\r\n    <el-button type=\"text\" @click=\"dialogFormVisible = true\" style=\"padding-left: 77px;\"\r\n    >+ 新增模块\r\n    </el-button>\r\n\r\n    <el-dialog title=\"新增一级模块\" :visible.sync=\"dialogFormVisible\" :modal-append-to-body=\"false\">\r\n      <el-form :model=\"form\">\r\n        <el-form-item label=\"模块名字\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.moduleName\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"模块简介\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.moduleRemark\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"insertLevelOne(form)\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <el-dialog title=\"新增二级模块\" :visible.sync=\"insertLevelTwoFormVisible\" :modal-append-to-body=\"false\">\r\n      <el-form :model=\"form\">\r\n        <el-form-item label=\"模块名字\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.moduleName\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"模块简介\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.moduleRemark\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"insertLevelTwoFormVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"insertLevelTwo(form)\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!--Level One-->\r\n    <el-dialog title=\"修改一级模块\" :visible.sync=\"updateLevelOneFormVisible\" :modal-append-to-body=\"false\">\r\n      <el-form :model=\"form\">\r\n        <el-form-item label=\"新名字\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.moduleName\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"新简介\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.moduleRemark\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"updateLevelOneFormVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"updateLevelOneModule(form)\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!--Level Two-->\r\n    <el-dialog title=\"修改二级模块\" :visible.sync=\"updateLevelTwoFormVisible\" :modal-append-to-body=\"false\">\r\n      <el-form :model=\"form\">\r\n        <el-form-item label=\"新名字\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.moduleName\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"新简介\" :label-width=\"formLabelWidth\">\r\n          <el-input v-model=\"form.moduleRemark\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"updateLevelTwoFormVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"updateLevelTwoModule(form)\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <div style=\"overflow-y: hidden; overflow-x: hidden\">\r\n      <!-- <p>使用 render-content</p> -->\r\n      <el-tree @node-click=\"nodeClick\"\r\n               v-if=\"data\" :data=\"data\"\r\n               :show-checkbox=false\r\n               node-key=\"id\"\r\n               default-expand-all\r\n               :expand-on-click-node=\"false\"\r\n               :render-content=\"renderContent\">\r\n\r\n      </el-tree>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport store from '../store';\r\nimport BugContentVue from './BugContent.vue';\r\n\r\nexport default {\r\n  name: 'side-bar',\r\n  data () {\r\n    const data = [];\r\n    return {\r\n      data: [],\r\n      options: [],\r\n      vm: this,\r\n      value: '',\r\n      // data: JSON.parse(JSON.stringify(data)),\r\n      // data: JSON.parse(JSON.stringify(data)),\r\n      dialogTableVisible: false,\r\n      dialogFormVisible: false,\r\n      nodeData: [],\r\n      form: {\r\n        moduleName: \"\",\r\n        moduleRemark: \"\"\r\n      },\r\n\r\n      insertLevelTwoFormVisible: false,\r\n      updateLevelOneFormVisible: false,\r\n      updateLevelTwoFormVisible: false,\r\n\r\n      formLabelWidth: '80px'\r\n    }\r\n  },\r\n  created () {\r\n\r\n    console.log(\"侧边栏 create函数执行了\");\r\n    this.$forceUpdate();\r\n    // 此时可以获取到data中的变量值\r\n    var numme = null;\r\n    this.postRequest(`/projects/selectAll`, numme).then(resp => {\r\n      // console.log(resp);\r\n      // console.log(this.options);\r\n      // console.log(resp);\r\n      this.options = resp.data;\r\n      this.update();\r\n      // console.log(this.options);\r\n    });\r\n  },\r\n\r\n  methods: {\r\n    onProChange(val) {\r\n      // console.log(val);\r\n      store.commit(\"editProjectName\", val);\r\n      console.log(\"store.state.projectName 值为 \" + store.state.projectName);\r\n      // this.update();\r\n\r\n      var _this = this;\r\n      //Edit\r\n      this.getRequest(`/modules/selectByProjectNameList`, {\r\n        params: { ProjectName: store.state.projectName },\r\n      }).then((resp) => {\r\n        console.log(\"In get List function\");\r\n        // console.log(resp.data);\r\n        this.data = resp.data;\r\n        store.commit(\"editModules\", resp.data);\r\n        console.log(\"store.state.modules 值为 \");\r\n\r\n        console.log(store.state.modules);\r\n        console.log(resp.data);\r\n        console.log(\"|_________________|\");\r\n\r\n        _this.update();\r\n      });\r\n    },\r\n\r\n    // 插入一级模块\r\n    insertLevelOne (form) {\r\n      var para = {\r\n        \"moduleName\": form.moduleName,\r\n        \"projectName\": store.state.projectName,\r\n        \"moduleLevel\": \"一级\",\r\n        \"moduleRemark\": form.moduleRemark\r\n      };\r\n\r\n\r\n      console.log(\"In insertLevelOne para:\");\r\n      console.log(para);\r\n\r\n      if (store.state.projectName === 'No choose') {\r\n        this.$message.error('错了哦,请先选择项目捏');\r\n        return;\r\n      }\r\n      if (form.moduleName === '') {\r\n        this.$message.error('错了哦,请不要提交空值捏');\r\n        return;\r\n      }\r\n\r\n\r\n      var _this = this;\r\n      this.postRequest(\"/modules/insertModule/\", para).then(resp => {\r\n        _this.update();\r\n      });\r\n\r\n      this.formClear();\r\n      this.dialogFormVisible = false;\r\n    },\r\n\r\n    // 插入二级模块\r\n    insertLevelTwo (form) {\r\n\r\n      //   console.log(form);\r\n      //   console.log(this.nodeData);\r\n      var para = {\r\n        \"moduleName\": form.moduleName,\r\n        \"projectName\": store.state.projectName,\r\n        \"moduleFather\": this.nodeData.id,\r\n        \"moduleLevel\": \"二级\",\r\n        \"moduleRemark\": form.moduleRemark\r\n      };\r\n\r\n      if (store.state.projectName === 'No choose') {\r\n        this.$message.error('错了哦,请先选择项目捏');\r\n        return;\r\n      }\r\n      if (form.moduleName === '') {\r\n        this.$message.error('错了哦,请不要提交空值捏');\r\n        return;\r\n      }\r\n\r\n      var _this = this;\r\n      this.postRequest(\"/modules/insertModule/\", para).then(resp => {\r\n        _this.update();\r\n      });\r\n\r\n      this.formClear();\r\n      this.insertLevelTwoFormVisible = false;\r\n    },\r\n\r\n    // 更新一级模块模块\r\n    updateLevelOneModule (form) {\r\n      // console.log(this.nodeData)\r\n      var para = {\r\n        \"moduleId\": this.nodeData.id,\r\n        \"moduleName\": form.moduleName,\r\n        \"projectName\": store.state.projectName,\r\n        // \"moduleFather\" : this.nodeData.id,\r\n        \"moduleLevel\": \"一级\",\r\n        \"moduleRemark\": form.moduleRemark\r\n      };\r\n\r\n      console.log(para)\r\n      if (store.state.projectName === 'No choose') {\r\n        this.$message.error('错了哦,请先选择项目捏');\r\n        return;\r\n      }\r\n      if (form.moduleName === '') {\r\n        this.$message.error('错了哦,请不要提交空值捏');\r\n        return;\r\n      }\r\n      this.postRequest(`/modules/updateById`, para).then(resp => {\r\n        // console.log(\"In updateById\");\r\n        // console.log(resp.data);\r\n        this.data = resp.data;\r\n        this.update();\r\n      });\r\n\r\n      this.formClear();\r\n      this.updateLevelOneFormVisible = false;\r\n    },\r\n\r\n    // 更新二级模块模块\r\n    updateLevelTwoModule (form) {\r\n      // console.log(this.nodeData)\r\n      var para = {\r\n        \"moduleId\": this.nodeData.id,\r\n        \"moduleName\": form.moduleName,\r\n        \"projectName\": store.state.projectName,\r\n        // \"moduleFather\" : this.nodeData.id,\r\n        \"moduleLevel\": \"二级\",\r\n        \"moduleRemark\": form.moduleRemark\r\n      };\r\n\r\n      console.log(para)\r\n      if (store.state.projectName === 'No choose') {\r\n        this.$message.error('错了哦,请先选择项目捏');\r\n        return;\r\n      }\r\n      if (form.moduleName === '') {\r\n        this.$message.error('错了哦,请不要提交空值捏');\r\n        return;\r\n      }\r\n\r\n      this.postRequest(`/modules/updateById`, para).then(resp => {\r\n        // console.log(\"In updateById\");\r\n        // console.log(resp.data);\r\n        this.data = resp.data;\r\n        this.update();\r\n      });\r\n\r\n      this.formClear();\r\n      this.updateLevelTwoFormVisible = false;\r\n    },\r\n\r\n    formClear () {\r\n      this.form.moduleName = \"\";\r\n      this.form.moduleRemark = \"\";\r\n    },\r\n\r\n    // 此方法已弃用\r\n    open () {\r\n      console.log(\"此方法已弃用\");\r\n\r\n      this.$prompt('请输入问题名称', '提示', {\r\n            confirmButtonText: '确定',\r\n            cancelButtonText: '取消',\r\n            //   inputPattern: /$/,\r\n            inputErrorMessage: '名称不能为空',\r\n\r\n          },\r\n      ).then(({value}) => {\r\n        console.log(value);\r\n        var pn = store.state.projectName;\r\n        var para = {\r\n          \"moduleName\": value,\r\n          \"projectName\": pn,\r\n          \"moduleLevel\": \"一级\",\r\n          \"moduleRemark\": \"ooo\"\r\n        };\r\n        var _this = this;\r\n        this.postRequest(\"/modules/insertModule/\", para).then(resp => {\r\n          _this.update();\r\n        });\r\n\r\n        this.$message({\r\n          type: 'success',\r\n          message: '问题为 ' + value\r\n        });\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '取消输入'\r\n        });\r\n      });\r\n    },\r\n\r\n    // 此方法已弃用\r\n    open2 (data) {\r\n      console.log(\"此方法已弃用\");\r\n\r\n      this.$prompt('请输入问题名称', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        //   inputPattern: /$/,\r\n        inputErrorMessage: '名称不能为空'\r\n      }).then(({value}) => {\r\n        console.log(value);\r\n        var pn = store.state.projectName;\r\n\r\n        console.log(\"IN OPEN2\");\r\n        console.log(data);\r\n\r\n        var temp = data.id;\r\n\r\n        var para = {\r\n          \"moduleName\": value,\r\n          \"projectName\": pn,\r\n          \"moduleFather\": temp,\r\n          \"moduleLevel\": \"二级\",\r\n          \"moduleRemark\": \"ooo\"\r\n        };\r\n        var _this = this;\r\n        this.postRequest(\"/modules/insertModule/\", para).then(resp => {\r\n          _this.update();\r\n        });\r\n\r\n        this.$message({\r\n          type: 'success',\r\n          message: '问题为 ' + value\r\n        });\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '取消输入'\r\n        });\r\n      });\r\n    },\r\n\r\n    // 删除一级或者二级模块\r\n    remove (node, data) {\r\n      var para = {'moduleId': data.id};\r\n      console.log(para);\r\n\r\n      var _this = this;\r\n\r\n      this.deleteRequest(`/modules/deleteById`, {params: para}).then(resp => {\r\n        console.log(\"In delete\");\r\n        _this.update();\r\n      });\r\n\r\n      this.formClear();\r\n    },\r\n\r\n    update () {\r\n      // 根据VueX中的projectName数据修改侧边栏树状视图\r\n      var val = store.state.projectName;\r\n      var params = {'ProjectName': val};\r\n      this.getRequest(`/modules/selectByProjectName`, {params}).then(resp => {\r\n        console.log(\"In update function\");\r\n        // console.log(resp.data);\r\n        this.data = resp.data;\r\n      });\r\n    },\r\n\r\n    renderContent (h, {node, data, store}) {\r\n      //console.log(\"IN renderContent\");\r\n      //console.log(node);\r\n      if (data.parentId != -1) { //当父亲节点不为-1时说明不是一级节点不可以新增\r\n        return (\r\n            <span class=\"custom-tree-node\">\r\n            <span>{ node.label }</span>\r\n            <span>\r\n                <el-button size=\"huge\" type=\"text\" icon='el-icon-edit' style=\"padding-right : 5px\"\r\n                           on-click={ () => {\r\n                             this.updateLevelTwoFormVisible = true;\r\n                             this.nodeData = data\r\n                           } }></el-button>\r\n\r\n                <el-popconfirm\r\n                    confirm-button-text='好的'\r\n                    cancel-button-text='不用了'\r\n                    icon=\"el-icon-info\"\r\n                    icon-color=\"red\"\r\n                    title=\"您确定删除这个节点吗？\"\r\n                    on-confirm={ () => this.remove(node, data) }\r\n                >\r\n                    <el-button size=\"huge\" type=\"text\" icon='el-icon-delete' slot=\"reference\"></el-button>\r\n                </el-popconfirm>\r\n            </span>\r\n            </span>\r\n        );\r\n      } else { //剩余的为一级节点可以更新\r\n        return (\r\n            <span class=\"custom-tree-node\">\r\n            <span>{ node.label }</span>\r\n            <span>\r\n                <el-button size=\"huge\" type=\"text\" icon='el-icon-circle-plus-outline'\r\n                           on-click={ () => {\r\n                             this.insertLevelTwoFormVisible = true;\r\n                             this.nodeData = data\r\n                           } }\r\n                ></el-button>\r\n\r\n                <el-button size=\"huge\" type=\"text\" icon='el-icon-edit' style=\"padding-right : 5px\"\r\n                           on-click={ () => {\r\n                             this.updateLevelOneFormVisible = true;\r\n                             this.nodeData = data;\r\n                           } }></el-button>\r\n\r\n                <el-popconfirm\r\n                    confirm-button-text='好的'\r\n                    cancel-button-text='不用了'\r\n                    icon=\"el-icon-info\"\r\n                    icon-color=\"red\"\r\n                    title=\"您确定删除这个节点吗？\"\r\n                    on-confirm={ () => this.remove(node, data) }\r\n                >\r\n                    <el-button size=\"huge\" type=\"text\" icon='el-icon-delete' slot=\"reference\"></el-button>\r\n                </el-popconfirm>\r\n            </span>\r\n            </span>\r\n        );\r\n      }\r\n    },\r\n\r\n    pop () {\r\n      console.log(1);\r\n    },\r\n\r\n    nodeClick (data, node, com) {\r\n      // console.log(\"In node click\");\r\n      // console.log(data);\r\n      // console.log(node);\r\n      // console.log(com);\r\n      //console.log(data.id);\r\n      // BugContentVue.methods.receive(data.id);\r\n      // store.commit('editModuleId', val);\r\n\r\n      console.log(\"In NodeClick\");\r\n      store.commit(\"editModuleId\", data.id);\r\n    }\r\n  },\r\n\r\n  //   getParentId(data){\r\n  //     // console.log(this.$refs.tree.getCheckedKeys());//当前选择节点\r\n  //     // console.log(this.$refs.tree.getHalfCheckedKeys());//父节点\r\n  //     // return[console.log(this.$refs.tree.getHalfCheckedKeys())]\r\n  //     return[data.parentID]\r\n  //   },\r\n\r\n  //   computed: {\r\n  //     changeButton: function(){\r\n  //       let buttonStatus = false;\r\n  //       if (getParentId==-1){\r\n  //           buttonStatus = true\r\n  //       }else {\r\n  //           buttonStatus = false\r\n  //       }\r\n  //       return buttonStatus;\r\n  //     }\r\n  //   },\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n/deep/ .custom-tree-node {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  font-size: 14px;\r\n  padding-right: 8px;\r\n}\r\n\r\n/deep/ .el-select {\r\n  left: 13px\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}