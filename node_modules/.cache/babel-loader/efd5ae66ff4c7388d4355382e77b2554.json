{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapMutations } from 'vuex';\nimport store from \"@/store\";\nimport { JSEncrypt } from \"jsencrypt\";\nimport { Message } from \"element-ui\";\nexport default {\n  name: \"Login\",\n\n  data() {\n    var validatePass2 = (rule, value, callback) => {\n      if (value !== this.registerForm.staffPswd) {\n        callback(new Error('两次输入密码不一致!'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      disabled: true,\n      staffType: \"普通员工\",\n      active: 0,\n      registerForm: {\n        staffCodeCheck: \"\",\n        staffId: \"jay\",\n        staffMail: \"1846324910@qq.com\",\n        staffName: \"jay\",\n        staffPswd: \"jay666\",\n        checkPswd: \"\"\n      },\n      loading: false,\n      //rules内容与prop的内容相对应  提示\n      rules: {\n        staffId: [{\n          required: true,\n          message: '请输入用户名',\n          trigger: 'blur'\n        }],\n        staffName: [{\n          required: true,\n          message: '请输入姓名',\n          trigger: 'blur'\n        }],\n        staffMail: [{\n          required: true,\n          message: '请输入账户绑定邮箱',\n          trigger: 'blur'\n        }],\n        staffPswd: [{\n          required: true,\n          message: '请输入密码',\n          trigger: 'blur'\n        }],\n        checkPswd: [{\n          validator: validatePass2,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n\n  methods: {\n    checkMail() {\n      this.postRequest('/mail/mailcheck', {\n        \"codeCheck\": this.registerForm.staffCodeCheck,\n        \"staffId\": this.registerForm.staffId,\n        \"staffMail\": this.registerForm.staffMail,\n        \"staffName\": this.registerForm.staffName,\n        \"staffPswd\": this.registerForm.staffPswd,\n        \"staffType\": this.staffType\n      }).then(resp => {\n        if (resp.code === \"200\") {\n          this.loading = false; //存储用户token\n          //跳转首页\n\n          this.disabled = false;\n          this.active = 1;\n        } else {\n          this.loading = false;\n          this.registerForm.staffId = \"\";\n          this.registerForm.staffPswd = \"\";\n          this.registerForm.staffName = \"\";\n          this.registerForm.staffMail = \"\";\n          this.registerForm.staffCodeCheck = \"\";\n          this.registerForm.checkPswd = \"\";\n        }\n      });\n    },\n\n    submitLogin() {\n      this.$router.push('/login');\n    },\n\n    submitRegister() {\n      this.$refs.registerForm.validate(valid => {\n        if (valid) {\n          this.active = 2;\n          this.postRequest('/staff/register', {\n            \"codeCheck\": this.registerForm.staffCodeCheck,\n            \"staffId\": this.registerForm.staffId,\n            \"staffMail\": this.registerForm.staffMail,\n            \"staffName\": this.registerForm.staffName,\n            \"staffPswd\": this.registerForm.staffPswd,\n            \"staffType\": this.staffType\n          }).then(resp => {\n            if (resp.code === \"200\") {\n              Message.success({\n                message: resp.msg\n              });\n              this.$router.push('/login');\n            } else if (resp.code === \"-2\") {\n              this.active = 1; //重名\n\n              this.registerForm.staffId = \"\";\n              Message.error({\n                message: resp.msg\n              });\n            } else {\n              //验证码错误,请重新验证并填写信息\n              Message.error({\n                message: resp.msg\n              });\n              this.active = 0;\n              this.registerForm.staffId = \"\";\n              this.registerForm.staffPswd = \"\";\n              this.registerForm.staffName = \"\";\n              this.registerForm.staffMail = \"\";\n              this.registerForm.staffCodeCheck = \"\";\n              this.registerForm.checkPswd = \"\";\n              this.disabled = true;\n            }\n          });\n        } else {\n          this.$message.error('请输入所有字段!');\n          return false;\n        }\n      });\n    }\n\n  },\n\n  beforeRouteEnter(to, from, next) {\n    document.querySelector('body').setAttribute('style', 'margin:0;padding:0');\n    next();\n  }\n\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;AACA;EACAA,aADA;;EAEAC;IACA;MACA;QACAC;MACA,CAFA,MAEA;QACAA;MACA;IACA,CANA;;IAQA;MACAC,cADA;MAEAC,iBAFA;MAGAC,SAHA;MAIAC;QACAC,kBADA;QAEAC,cAFA;QAGAC,8BAHA;QAIAC,gBAJA;QAKAC,mBALA;QAMAC;MANA,CAJA;MAYAC,cAZA;MAaA;MACAC;QACAN,UACA;UAAAO;UAAAC;UAAAC;QAAA,CADA,CADA;QAIAP,YACA;UAAAK;UAAAC;UAAAC;QAAA,CADA,CAJA;QAOAR,YACA;UAAAM;UAAAC;UAAAC;QAAA,CADA,CAPA;QAUAN,YACA;UAAAI;UAAAC;UAAAC;QAAA,CADA,CAVA;QAaAL;UAAAM;UAAAD;QAAA;MAbA;IAdA;EA8BA,CAzCA;;EA0CAE;IACAC;MACA;QACA,6CADA;QAEA,oCAFA;QAGA,wCAHA;QAIA,wCAJA;QAKA,wCALA;QAMA;MANA,GAOAC,IAPA,CAOAC;QACA;UACA,qBADA,CAEA;UACA;;UACA;UACA;QACA,CANA,MAOA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;MACA,CAxBA;IAyBA,CA3BA;;IA4BAC;MACA;IACA,CA9BA;;IA+BAC;MACA;QACA;UACA;UACA;YACA,6CADA;YAEA,oCAFA;YAGA,wCAHA;YAIA,wCAJA;YAKA,wCALA;YAMA;UANA,GAOAH,IAPA,CAOAC;YACA;cACAG;gBAAAT;cAAA;cACA;YACA,CAHA,MAIA;cACA,gBADA,CAEA;;cACA;cACAS;gBAAAT;cAAA;YACA,CALA,MAKA;cACA;cACAS;gBAAAT;cAAA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;YACA;UACA,CA7BA;QA8BA,CAhCA,MAgCA;UACA;UACA;QACA;MACA,CArCA;IAsCA;;EAtEA,CA1CA;;EAkHAU;IACAC;IACAC;EACA;;AArHA","names":["name","data","callback","disabled","staffType","active","registerForm","staffCodeCheck","staffId","staffMail","staffName","staffPswd","checkPswd","loading","rules","required","message","trigger","validator","methods","checkMail","then","resp","submitLogin","submitRegister","Message","beforeRouteEnter","document","next"],"sourceRoot":"src/views","sources":["Register.vue"],"sourcesContent":["<template>\r\n  <div class=\"loginPage\">\r\n    <div class=\"left\">\r\n      <div class=\"top\">\r\n        <div class=\"topLogo\">\r\n          <img src=\"../assets/img_1.png\" class=\"imageLogo\"/>\r\n        </div>\r\n        <div class=\"topName\">\r\n          科大国创项目管理系统\r\n        </div>\r\n      </div>\r\n      <div class=\"content\"></div>\r\n    </div>\r\n\r\n    <div class=\"right\">\r\n\r\n      <el-form :rules=\"rules\" ref=\"registerForm\" :model=\"registerForm\" class=\"loginContainer\"\r\n               v-loading=\"loading\"\r\n               element-loading-text=\"正在跳转到登录页面中...\">\r\n        <h3 class=\"loginTitle\">注&nbsp;&nbsp;册</h3>\r\n        <el-steps :active=\"active\" finish-status=\"success\" align-center>\r\n          <el-step title=\"邮箱验证\"></el-step>\r\n          <el-step title=\"注册信息确认\"></el-step>\r\n          <el-step title=\"注册成功\"></el-step>\r\n        </el-steps>\r\n\r\n        <el-form-item prop=\"staffId\">\r\n          <el-input auto-complete=\"false\" v-model=\"registerForm.staffId\" placeholder=\"请输入帐号ID\" clearable></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"staffName\">\r\n          <el-input auto-complete=\"false\" v-model=\"registerForm.staffName\" placeholder=\"请输入您的姓名\" clearable></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"staffMail\" style=\"display: flow\">\r\n          <el-input auto-complete=\"false\" v-model=\"registerForm.staffMail\" placeholder=\"请输入账户绑定邮箱\" clearable style=\"width: 300px\"></el-input>\r\n          <el-button @click=\"checkMail\" style=\"width: 80px;margin-left: 20px\">验证</el-button>\r\n        </el-form-item>\r\n        <el-form-item  prop=\"staffCodeCheck\">\r\n          <el-input v-model=\"registerForm.staffCodeCheck\" autocomplete=\"off\" placeholder=\"请输入验证码\"  clearable></el-input>\r\n        </el-form-item>\r\n        <el-form-item  prop=\"staffPswd\">\r\n          <el-input type=\"password\" v-model=\"registerForm.staffPswd\" autocomplete=\"off\" placeholder=\"设置用户密码\" show-password clearable></el-input>\r\n        </el-form-item>\r\n        <el-form-item  prop=\"checkPswd\">\r\n          <el-input type=\"password\" v-model=\"registerForm.checkPswd\" autocomplete=\"off\" placeholder=\"确认密码\" show-password clearable></el-input>\r\n        </el-form-item>\r\n        <span class=\"font_account\">已有帐号?</span>\r\n        <el-link target=\"_blank\" @click=\"submitLogin\" class=\"loginButton\">立即登录</el-link>\r\n        <el-button type=\"primary\" style=\"width:100%\" @click=\"submitRegister\" class=\"registerButton\" :disabled=\"disabled\">注册</el-button>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations } from 'vuex';\r\nimport store from \"@/store\";\r\nimport { JSEncrypt } from \"jsencrypt\";\r\nimport { Message } from \"element-ui\";\r\nexport default {\r\n  name: \"Login\",\r\n  data(){\r\n    var validatePass2 = (rule, value, callback) => {\r\n     if (value !== this.registerForm.staffPswd) {\r\n        callback(new Error('两次输入密码不一致!'));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n\r\n    return{\r\n      disabled: true,\r\n      staffType: \"普通员工\",\r\n      active: 0,\r\n      registerForm:{\r\n        staffCodeCheck:\"\",\r\n        staffId:\"jay\",\r\n        staffMail:\"1846324910@qq.com\",\r\n        staffName:\"jay\",\r\n        staffPswd:\"jay666\",\r\n        checkPswd:\"\"\r\n      },\r\n      loading: false,\r\n      //rules内容与prop的内容相对应  提示\r\n      rules:{\r\n        staffId:[\r\n          {required:true,message:'请输入用户名',trigger:'blur'}\r\n        ],\r\n        staffName:[\r\n          {required:true,message:'请输入姓名',trigger:'blur'}\r\n        ],\r\n        staffMail:[\r\n          {required:true,message:'请输入账户绑定邮箱',trigger:'blur'}\r\n        ],\r\n        staffPswd:[\r\n          {required:true,message:'请输入密码',trigger:'blur'}\r\n        ],\r\n        checkPswd:[{ validator: validatePass2, trigger: 'blur' }]\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    checkMail(){\r\n      this.postRequest('/mail/mailcheck',{\r\n        \"codeCheck\": this.registerForm.staffCodeCheck,\r\n        \"staffId\": this.registerForm.staffId,\r\n        \"staffMail\": this.registerForm.staffMail,\r\n        \"staffName\": this.registerForm.staffName,\r\n        \"staffPswd\": this.registerForm.staffPswd,\r\n        \"staffType\": this.staffType\r\n      }).then(resp=>{\r\n        if(resp.code === \"200\"){\r\n          this.loading = false;\r\n          //存储用户token\r\n          //跳转首页\r\n          this.disabled = false;\r\n          this.active = 1;\r\n        }\r\n        else{\r\n          this.loading = false;\r\n          this.registerForm.staffId=\"\";\r\n          this.registerForm. staffPswd=\"\";\r\n          this.registerForm.staffName=\"\";\r\n          this.registerForm.staffMail=\"\";\r\n          this.registerForm.staffCodeCheck=\"\";\r\n          this.registerForm.checkPswd=\"\";\r\n        }\r\n      })\r\n    },\r\n    submitLogin(){\r\n      this.$router.push('/login');\r\n    },\r\n    submitRegister(){\r\n      this.$refs.registerForm.validate((valid) => {\r\n        if (valid) {\r\n          this.active = 2;\r\n          this.postRequest('/staff/register',{\r\n            \"codeCheck\": this.registerForm.staffCodeCheck,\r\n            \"staffId\": this.registerForm.staffId,\r\n            \"staffMail\": this.registerForm.staffMail,\r\n            \"staffName\": this.registerForm.staffName,\r\n            \"staffPswd\": this.registerForm.staffPswd,\r\n            \"staffType\": this.staffType\r\n          }).then(resp=>{\r\n            if(resp.code === \"200\"){\r\n              Message.success({message: resp.msg});\r\n              this.$router.push('/login');\r\n            }\r\n            else if(resp.code === \"-2\"){\r\n              this.active = 1;\r\n              //重名\r\n              this.registerForm.staffId=\"\";\r\n              Message.error({message: resp.msg});\r\n            }else{\r\n              //验证码错误,请重新验证并填写信息\r\n              Message.error({message: resp.msg});\r\n              this.active = 0;\r\n              this.registerForm.staffId=\"\";\r\n              this.registerForm. staffPswd=\"\";\r\n              this.registerForm.staffName=\"\";\r\n              this.registerForm.staffMail=\"\";\r\n              this.registerForm.staffCodeCheck=\"\";\r\n              this.registerForm.checkPswd=\"\";\r\n              this.disabled = true;\r\n            }\r\n          })\r\n        } else {\r\n          this.$message.error('请输入所有字段!');\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n  },\r\n  beforeRouteEnter (to, from, next) {\r\n    document.querySelector('body').setAttribute('style', 'margin:0;padding:0')\r\n    next()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.loginPage{\r\n  background-color: #ffffff;\r\n  height: 100%;\r\n  position: fixed;\r\n  width: 100%;\r\n  border:none;\r\n}\r\n.left{\r\n  float: left;\r\n  width:55%;\r\n  height:100%;\r\n}\r\n.right{\r\n  float: left;\r\n  width:45%;\r\n  height:100%;\r\n}\r\n.topLogo{\r\n  float:left;\r\n}\r\n.imageLogo{\r\n  height:40px;\r\n  width:110px;\r\n}\r\n.topName{\r\n  float: left;\r\n  font-weight: bold;\r\n  height: 20px;\r\n  width: 300px;\r\n  margin: 8px 5px 15px 30px;\r\n}\r\n.content{\r\n  margin-top:40px;\r\n  background-image: url(\"../assets/background.png\");\r\n  background-size: 100% 100%;\r\n  height: 95%;\r\n  width: 55%;\r\n  position: fixed;\r\n}\r\n.loginContainer{\r\n  border-radius: 15px;\r\n  background-clip: padding-box;\r\n  margin: 40px 140px;\r\n  width: 400px;\r\n  height: 660px;\r\n  padding: 15px 35px 25px 35px;\r\n  background: #fff;\r\n  border: 1px solid #eaeaea;\r\n  box-shadow: 0 0 25px #cac6c6;\r\n}\r\n.loginTitle{\r\n  margin: 20px auto 45px auto;\r\n  text-align: center;\r\n  font-weight: bold;\r\n  font-size: 26px;\r\n}\r\n/deep/.el-form-item{\r\n  margin-bottom:30px;\r\n}\r\n.loginButton{\r\n  margin-top: -3px;\r\n  margin-left: 10px;\r\n  font-weight: bold;\r\n}\r\n.font_account{\r\n  color: #606266;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n}\r\n.registerButton{\r\n  margin-top:23px;\r\n  margin-left: 0px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}