{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport barTemplate from \"../components/Bar.vue\";\nimport lineTemplate from \"../components/Line.vue\";\nimport pieTemplate from \"../components/Pie.vue\";\nimport contrastTemplate from \"../components/Contrast\";\nconst typeOptions = [{\n  'id': 1,\n  'name': '按项目统计bug数'\n}, {\n  'id': 2,\n  'name': '按模块统计bug数'\n}, {\n  'id': 3,\n  'name': '每天新增的bug数'\n}, {\n  'id': 4,\n  'name': '每日关闭bug数'\n}, {\n  'id': 5,\n  'name': '每人创建bug数'\n}, {\n  'id': 6,\n  'name': '每人完成bug数'\n}, {\n  'id': 7,\n  'name': '每人关闭bug数'\n}, {\n  'id': 8,\n  'name': '按bug类型统计bug数'\n}, {\n  'id': 9,\n  'name': '按紧急程度统计'\n}, {\n  'id': 10,\n  'name': '按优先级统计'\n}, {\n  'id': 11,\n  'name': '按状态统计'\n}];\nexport default {\n  name: \"Report\",\n  components: {\n    barTemplate,\n    lineTemplate,\n    pieTemplate,\n    contrastTemplate\n  },\n\n  data() {\n    return {\n      input: 'OTC研发项目',\n      chartsType: 'bar',\n      checkAll: false,\n      checkedTypes: [],\n      types: typeOptions,\n      // 可供的选项内容\n      dataChecked: [],\n      // 已选择的内容\n      isIndeterminate: true,\n      returnData: [],\n      barShow: false,\n      pieShow: false,\n      lineShow: false,\n      contrastShow: false,\n      dynamicTags: [],\n      inputVisible: false,\n      options: [],\n      value: '',\n      selectData: {},\n      isQuery: false\n    };\n  },\n\n  created() {\n    let numme = null;\n    this.postRequest(`/projects/selectAll`, numme).then(resp => {\n      this.options = resp.data;\n    });\n  },\n\n  methods: {\n    // 关于筛选所涉及到的方法\n    handleClose(tag) {\n      this.dynamicTags.splice(this.dynamicTags.indexOf(tag), 1); // 去掉禁选项\n\n      for (let i = 0; i < this.options.length; i++) {\n        if (tag == this.options[i].projectName) {\n          this.options[i].disabled = false;\n        }\n      }\n    },\n\n    showInput() {\n      this.inputVisible = true;\n    },\n\n    onProChange() {\n      let value = this.value;\n\n      if (value) {\n        this.dynamicTags.push(value); // 设置禁选项\n\n        for (let i = 0; i < this.options.length; i++) {\n          if (value == this.options[i].projectName) {\n            this.options[i].disabled = true;\n          }\n        }\n      }\n\n      this.inputVisible = false;\n      this.value = '';\n    },\n\n    // 多选框使用的方法\n    handleCheckAllChange(val) {\n      // val: 选中为true、未选中为false\n      let i;\n      let checkedList = [];\n      let dataCheckedId = [];\n\n      if (val) {\n        for (i = 0; i < 11; i++) {\n          dataCheckedId.push(i + 1);\n          checkedList.push(typeOptions[i].name);\n        }\n\n        this.dataChecked = dataCheckedId; // console.log(this.dataChecked);\n\n        this.checkedTypes = checkedList;\n      } else {\n        this.dataChecked = []; //console.log(this.dataChecked);\n\n        this.checkedTypes = [];\n      }\n\n      this.isIndeterminate = false;\n    },\n\n    handleCheckedTypesChange(value) {\n      let checkedCount = value.length;\n      this.checkAll = checkedCount === this.types.length;\n      this.isIndeterminate = checkedCount > 0 && checkedCount < this.types.length;\n    },\n\n    handleChange(e, id) {\n      if (e) {\n        this.dataChecked.push(id);\n      } else {\n        this.delete(id);\n      }\n    },\n\n    delete(id) {\n      let index = this.dataChecked.findIndex(item => {\n        if (item == id) {\n          return true;\n        }\n      });\n      this.dataChecked.splice(index, 1);\n    },\n\n    searchClick(tab, event) {\n      console.log(tab, event);\n    },\n\n    requestClick() {\n      this.isQuery = true;\n      this.submitInformation();\n    },\n\n    submitInformation() {\n      this.dataChecked.sort(function (a, b) {\n        return a - b;\n      });\n\n      if (this.dynamicTags.length != 0) {\n        this.selectData = {\n          \"arr\": this.dataChecked,\n          \"strings\": this.dynamicTags\n        };\n      } else {\n        this.selectData = {\n          \"arr\": this.dataChecked,\n          \"strings\": this.options.map(element => element.projectName)\n        };\n      }\n\n      console.log(this.dataChecked);\n\n      if (this.dataChecked.length == 0) {\n        this.$message.error('请选择要生成的报表类型!');\n      } else {\n        this.postRequest('/bugs/charts', this.selectData).then(resp => {\n          // 反馈回来各个报表类型所对应的报表名称及其bug数.\n          if (resp.code == \"200\") {\n            if (this.isQuery) {\n              this.$message({\n                message: '查询成功!',\n                type: 'success'\n              });\n            } else {\n              this.$message({\n                message: '生成报表成功!',\n                type: 'success'\n              });\n            }\n\n            this.returnData = resp.data;\n            this.barShow = false;\n            this.pieShow = false;\n            this.lineShow = false;\n            this.contrastShow = false;\n            this.$nextTick(function () {\n              // 加载\n              this.barShow = true;\n              this.pieShow = true;\n              this.lineShow = true;\n              this.contrastShow = true;\n            });\n          } else {\n            if (this.isQuery) {\n              this.$message.error('查询失败!');\n            } else {\n              this.$message.error('生成报表失败!');\n            }\n          }\n\n          this.isQuery = false;\n        });\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DA;AACA;AACA;AACA;AACA,qBACA;EACA,OADA;EAEA;AAFA,CADA,EAKA;EACA,OADA;EAEA;AAFA,CALA,EASA;EACA,OADA;EAEA;AAFA,CATA,EAaA;EACA,OADA;EAEA;AAFA,CAbA,EAiBA;EACA,OADA;EAEA;AAFA,CAjBA,EAqBA;EACA,OADA;EAEA;AAFA,CArBA,EAyBA;EACA,OADA;EAEA;AAFA,CAzBA,EA6BA;EACA,OADA;EAEA;AAFA,CA7BA,EAiCA;EACA,OADA;EAEA;AAFA,CAjCA,EAqCA;EACA,QADA;EAEA;AAFA,CArCA,EAyCA;EACA,QADA;EAEA;AAFA,CAzCA;AA8CA;EACAA,cADA;EAEAC;IAAAC;IAAAC;IAAAC;IAAAC;EAAA,CAFA;;EAGAC;IACA;MACAC,gBADA;MAEAC,iBAFA;MAGAC,eAHA;MAIAC,gBAJA;MAKAC,kBALA;MAKA;MACAC,eANA;MAMA;MACAC,qBAPA;MAQAC,cARA;MASAC,cATA;MAUAC,cAVA;MAWAC,eAXA;MAYAC,mBAZA;MAaAC,eAbA;MAcAC,mBAdA;MAeAC,WAfA;MAgBAC,SAhBA;MAiBAC,cAjBA;MAkBAC;IAlBA;EAoBA,CAxBA;;EAyBAC;IACA;IACA;MACA;IACA,CAFA;EAGA,CA9BA;;EA+BAC;IACA;IACAC;MACA,0DADA,CAEA;;MACA;QACA;UACA;QACA;MACA;IACA,CAVA;;IAYAC;MACA;IACA,CAdA;;IAgBAC;MACA;;MACA;QACA,6BADA,CAEA;;QACA;UACA;YACA;UACA;QACA;MACA;;MACA;MACA;IACA,CA7BA;;IA+BA;IACAC;MACA;MACA;MACA;MACA;;MACA;QACA;UACAC;UACAC;QACA;;QACA,iCALA,CAMA;;QACA;MACA,CARA,MASA;QACA,sBADA,CAEA;;QACA;MACA;;MACA;IACA,CApDA;;IAqDAC;MACA;MACA;MACA;IACA,CAzDA;;IA0DAC;MACA;QACA;MACA,CAFA,MAGA;QACA;MACA;IACA,CAjEA;;IAkEAC;MACA;QACA;UACA;QACA;MACA,CAJA;MAKA;IACA,CAzEA;;IA0EAC;MACAC;IACA,CA5EA;;IA6EAC;MACA;MACA;IACA,CAhFA;;IAiFAC;MACA;QACA;MACA,CAFA;;MAGA;QACA;UACA,uBADA;UAEA;QAFA;MAIA,CALA,MAMA;QACA;UACA,uBADA;UAEA;QAFA;MAIA;;MACAF;;MACA;QACA;MACA,CAFA,MAGA;QACA;UACA;UACA;YACA;cACA;gBACAG,gBADA;gBAEAC;cAFA;YAIA,CALA,MAMA;cACA;gBACAD,kBADA;gBAEAC;cAFA;YAIA;;YACA;YACA;YACA;YACA;YACA;YACA;cACA;cACA;cACA;cACA;cACA;YACA,CANA;UAOA,CAzBA,MA0BA;YACA;cACA;YACA,CAFA,MAGA;cACA;YACA;UACA;;UACA;QACA,CArCA;MAsCA;IACA;;EA7IA;AA/BA","names":["name","components","barTemplate","lineTemplate","pieTemplate","contrastTemplate","data","input","chartsType","checkAll","checkedTypes","types","dataChecked","isIndeterminate","returnData","barShow","pieShow","lineShow","contrastShow","dynamicTags","inputVisible","options","value","selectData","isQuery","created","methods","handleClose","showInput","onProChange","handleCheckAllChange","dataCheckedId","checkedList","handleCheckedTypesChange","handleChange","delete","searchClick","console","requestClick","submitInformation","message","type"],"sourceRoot":"src/views","sources":["Report.vue"],"sourcesContent":["<template>\r\n  <el-container>\r\n    <div style = 'width:300px;margin-left:20px;'>\r\n      <el-aside width=\"280px\" class=\"table_left\">\r\n        <div class=\"table_left_topFont\">请选择报表类型</div>\r\n        <el-checkbox :indeterminate=\"isIndeterminate\" v-model=\"checkAll\" @change=\"handleCheckAllChange\" class=\"table_left_checkbox_all\">全选</el-checkbox>\r\n        <el-checkbox-group v-model=\"checkedTypes\" @change=\"handleCheckedTypesChange\">\r\n          <el-checkbox v-for=\"item in types\" :label=\"item.name\" :key=\"item.name\" @change=\"handleChange($event,item.id)\">{{item.name}}</el-checkbox>\r\n        </el-checkbox-group>\r\n        <div class=\"table_left_button\">\r\n          <el-button type=\"primary\" plain @click=\"submitInformation\">生成报表</el-button>\r\n        </div>\r\n      </el-aside>\r\n    </div>\r\n    <el-main class=\"table_right\" style = \"overflow-y: scroll;scrollbar-width:none\">\r\n      <el-container>\r\n        <el-header>\r\n          <el-tag\r\n              :key=\"tag\"\r\n              v-for=\"tag in dynamicTags\"\r\n              closable\r\n              :disable-transitions=\"false\"\r\n              @close=\"handleClose(tag)\">\r\n            {{tag}}\r\n          </el-tag>\r\n          <el-select v-if=\"inputVisible\" v-model=\"value\" class=\"input-new-tag\" placeholder=\"请输入要进行筛选的项目名称\"  ref=\"saveTagInput\" @change=\"onProChange\" >\r\n            <el-option\r\n                v-for=\"item in options\"\r\n                :key=\"item.projectName\"\r\n                :label=\"item.projectName\"\r\n                :value=\"item.projectName\"\r\n                :disabled=\"item.disabled\"\r\n                >\r\n            </el-option>\r\n          </el-select>\r\n          <el-button v-else class=\"button-new-tag\" size=\"small\" @click=\"showInput\">+ 筛选</el-button>\r\n          <el-button size=\"small\" type=\"primary\" icon=\"el-icon-search\" class=\"searchButton\" @click=\"requestClick\">查询</el-button>\r\n        </el-header>\r\n        <el-main>\r\n          <el-tabs v-model=\"chartsType\" @tab-click=\"searchClick\">\r\n            <el-tab-pane label=\"条形图\" name=\"bar\">\r\n              <barTemplate :chosenData=\"returnData\" :dataOfCheck=\"dataChecked\" :typeOfOptions=\"types\" v-if=\"barShow\"></barTemplate>\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"折线图\" name=\"line\">\r\n              <lineTemplate :chosenDataLine=\"returnData\" :dataOfCheckLine=\"dataChecked\" :typeOfOptionsLine=\"types\" v-if=\"lineShow\"></lineTemplate>\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"饼状图\" name=\"pie\">\r\n              <pieTemplate :chosenDataPie=\"returnData\" :dataOfCheckPie=\"dataChecked\" :typeOfOptionsPie=\"types\" v-if=\"pieShow\"></pieTemplate>\r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"对比分析图\" name=\"contrast\">\r\n              <contrastTemplate :chosenDataContrast=\"returnData\" :dataOfCheckContrast=\"dataChecked\" :typeOfOptionsContrast=\"types\" v-if=\"contrastShow\"></contrastTemplate>\r\n            </el-tab-pane>\r\n          </el-tabs>\r\n        </el-main>\r\n      </el-container>\r\n    </el-main>\r\n  </el-container>\r\n</template>\r\n\r\n<script>\r\nimport barTemplate from \"../components/Bar.vue\";\r\nimport lineTemplate from \"../components/Line.vue\";\r\nimport pieTemplate from \"../components/Pie.vue\";\r\nimport contrastTemplate from \"../components/Contrast\";\r\nconst typeOptions = [\r\n  {\r\n    'id': 1,\r\n    'name': '按项目统计bug数'\r\n  },\r\n  {\r\n    'id': 2,\r\n    'name': '按模块统计bug数'\r\n  },\r\n  {\r\n    'id': 3,\r\n    'name': '每天新增的bug数'\r\n  },\r\n  {\r\n    'id': 4,\r\n    'name': '每日关闭bug数'\r\n  },\r\n  {\r\n    'id': 5,\r\n    'name': '每人创建bug数'\r\n  },\r\n  {\r\n    'id': 6,\r\n    'name': '每人完成bug数'\r\n  },\r\n  {\r\n    'id': 7,\r\n    'name': '每人关闭bug数'\r\n  },\r\n  {\r\n    'id': 8,\r\n    'name': '按bug类型统计bug数'\r\n  },\r\n  {\r\n    'id': 9,\r\n    'name': '按紧急程度统计'\r\n  },\r\n  {\r\n    'id': 10,\r\n    'name': '按优先级统计'\r\n  },\r\n  {\r\n    'id': 11,\r\n    'name': '按状态统计'\r\n  }\r\n];\r\nexport default {\r\n  name: \"Report\",\r\n  components:{barTemplate, lineTemplate, pieTemplate, contrastTemplate},\r\n  data () {\r\n    return {\r\n      input:'OTC研发项目',\r\n      chartsType:'bar',\r\n      checkAll: false,\r\n      checkedTypes: [],\r\n      types: typeOptions, // 可供的选项内容\r\n      dataChecked:[], // 已选择的内容\r\n      isIndeterminate: true,\r\n      returnData:[],\r\n      barShow: false,\r\n      pieShow: false,\r\n      lineShow: false,\r\n      contrastShow: false,\r\n      dynamicTags: [],\r\n      inputVisible: false,\r\n      options: [],\r\n      value: '',\r\n      selectData:{},\r\n      isQuery: false\r\n    }\r\n  },\r\n  created(){\r\n    let numme = null;\r\n    this.postRequest(`/projects/selectAll`, numme).then(resp=>{\r\n      this.options = resp.data;\r\n    });\r\n  },\r\n  methods: {\r\n    // 关于筛选所涉及到的方法\r\n    handleClose(tag) {\r\n      this.dynamicTags.splice(this.dynamicTags.indexOf(tag), 1);\r\n      // 去掉禁选项\r\n      for(let i = 0; i < this.options.length; i++){\r\n        if(tag == this.options[i].projectName){\r\n          this.options[i].disabled = false;\r\n        }\r\n      }\r\n    },\r\n\r\n    showInput() {\r\n      this.inputVisible = true;\r\n    },\r\n\r\n    onProChange() {\r\n      let value = this.value;\r\n      if (value) {\r\n        this.dynamicTags.push(value);\r\n        // 设置禁选项\r\n        for(let i = 0; i < this.options.length; i++){\r\n          if(value == this.options[i].projectName){\r\n            this.options[i].disabled = true;\r\n          }\r\n        }\r\n      }\r\n      this.inputVisible = false;\r\n      this.value = '';\r\n    },\r\n\r\n    // 多选框使用的方法\r\n    handleCheckAllChange (val) {\r\n      // val: 选中为true、未选中为false\r\n      let i;\r\n      let checkedList = [];\r\n      let dataCheckedId = [];\r\n      if(val){\r\n        for(i = 0; i < 11 ;i++){\r\n          dataCheckedId.push(i+1);\r\n          checkedList.push(typeOptions[i].name);\r\n        }\r\n        this.dataChecked = dataCheckedId;\r\n       // console.log(this.dataChecked);\r\n        this.checkedTypes = checkedList;\r\n      }\r\n      else{\r\n        this.dataChecked = [];\r\n        //console.log(this.dataChecked);\r\n        this.checkedTypes = [];\r\n      }\r\n      this.isIndeterminate = false;\r\n    },\r\n    handleCheckedTypesChange (value) {\r\n      let checkedCount = value.length;\r\n      this.checkAll = checkedCount === this.types.length;\r\n      this.isIndeterminate = checkedCount > 0 && checkedCount < this.types.length;\r\n    },\r\n    handleChange (e,id) {\r\n      if(e){\r\n        this.dataChecked.push(id);\r\n      }\r\n      else{\r\n        this.delete(id);\r\n      }\r\n    },\r\n    delete(id){\r\n        let index = this.dataChecked.findIndex(item => {\r\n          if(item == id){\r\n            return true;\r\n          }\r\n        });\r\n        this.dataChecked.splice(index,1);\r\n    },\r\n    searchClick (tab, event) {\r\n      console.log(tab, event);\r\n    },\r\n    requestClick(){\r\n      this.isQuery = true;\r\n      this.submitInformation();\r\n    },\r\n    submitInformation () {\r\n      this.dataChecked.sort(function (a, b) {\r\n        return a - b;\r\n      });\r\n      if(this.dynamicTags.length != 0){\r\n        this.selectData = {\r\n          \"arr\": this.dataChecked,\r\n          \"strings\": this.dynamicTags\r\n        }\r\n      }\r\n      else{\r\n        this.selectData = {\r\n          \"arr\": this.dataChecked,\r\n          \"strings\": this.options.map(element => element.projectName)\r\n        }\r\n      }\r\n      console.log(this.dataChecked);\r\n      if(this.dataChecked.length == 0){\r\n        this.$message.error('请选择要生成的报表类型!');\r\n      }\r\n      else{\r\n        this.postRequest('/bugs/charts',this.selectData).then(resp =>{\r\n          // 反馈回来各个报表类型所对应的报表名称及其bug数.\r\n          if(resp.code == \"200\"){\r\n            if(this.isQuery){\r\n              this.$message({\r\n                message: '查询成功!',\r\n                type: 'success'\r\n              });\r\n            }\r\n            else{\r\n              this.$message({\r\n                message: '生成报表成功!',\r\n                type: 'success'\r\n              });\r\n            }\r\n            this.returnData = resp.data;\r\n            this.barShow = false;\r\n            this.pieShow = false;\r\n            this.lineShow = false;\r\n            this.contrastShow = false;\r\n            this.$nextTick(function(){\r\n              // 加载\r\n              this.barShow = true;\r\n              this.pieShow = true;\r\n              this.lineShow = true;\r\n              this.contrastShow = true;\r\n            });\r\n          }\r\n          else{\r\n            if(this.isQuery){\r\n              this.$message.error('查询失败!');\r\n            }\r\n            else{\r\n              this.$message.error('生成报表失败!');\r\n            }\r\n          }\r\n          this.isQuery = false;\r\n        })\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.table_left{\r\n  margin-left: 10px;\r\n  margin-top: 10px;\r\n  border-radius: 15px;\r\n  padding: 15px 35px 25px 15px;\r\n  background: #fff;\r\n  border: 1px solid #eaeaea;\r\n  box-shadow: 0 0 25px #cac6c6;\r\n}\r\n.table_left_topFont{\r\n  margin-left: 20px;\r\n  font-weight: bold;\r\n  margin-top: 10px;\r\n  font-family:\"Microsoft YaHei\";\r\n}\r\n/deep/.el-checkbox{\r\n  margin-top: 12px;\r\n  margin-left: 20px;\r\n  letter-spacing: 0.5px;\r\n  font-family:\"Microsoft YaHei\";\r\n}\r\n/deep/.el-checkbox__label{\r\n  font-weight:500;\r\n}\r\n.table_left_checkbox_all{\r\n  margin-top:20px;\r\n}\r\n.table_left_button{\r\n  margin-top:20px;\r\n  text-align: center;\r\n}\r\n.table_right {\r\n  margin-left: 10px;\r\n  margin-top: 10px;\r\n  border-radius: 15px;\r\n  padding: 15px 35px 25px 15px;\r\n  background: #fff;\r\n  border: 1px solid #eaeaea;\r\n  margin-right: 20px;\r\n  height: 575px;\r\n  /*box-shadow: 0 0 25px #cac6c6;*/\r\n}\r\n/deep/.el-header{\r\n  padding:0px 0px !important;\r\n}\r\n.selectButton{\r\n  margin-left:10px !important;\r\n}\r\n.searchButton{\r\n  margin-left:16px !important;\r\n}\r\n/deep/.el-tabs__header{\r\n  margin-top:-30px !important;\r\n}\r\n/*.chartsStyle{*/\r\n/*  width:500px;*/\r\n/*}*/\r\n/*筛选、下拉框的样式*/\r\n.el-tag + .el-tag {\r\n  margin-left: 10px;\r\n}\r\n.button-new-tag {\r\n  margin-left: 10px;\r\n  height: 33px;\r\n  line-height: 30px;\r\n  padding-top: 0;\r\n  padding-bottom: 0;\r\n  font-weight: bold;\r\n  color: black;\r\n  font-size: 12px;\r\n  font-family: \"Microsoft YaHei\";\r\n}\r\n.input-new-tag {\r\n  width: 250px;\r\n  margin-left: 10px;\r\n  vertical-align: bottom;\r\n}\r\n/deep/.el-input__inner{\r\n  height:32px;\r\n}\r\n/deep/.el-input__icon{\r\n  line-height: 30px;\r\n}\r\n/deep/.el-input{\r\n  font-size: 13px;\r\n}\r\n\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}