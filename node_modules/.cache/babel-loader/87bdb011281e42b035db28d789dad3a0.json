{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"axios\";\nimport { sub } from \"zrender/lib/core/vector\";\nimport store from \"@/store\";\nimport { Message } from \"element-ui\";\nexport default {\n  name: \"bug_form\",\n\n  created() {\n    // console.log(\"In Created Content\");\n    // console.log(this.priority);\n    this.related_modules = store.state.modules;\n  },\n\n  methods: {\n    init(data) {\n      this.detailVisible = true;\n      console.log(data);\n    },\n\n    Close() {\n      this.$parent.ClosetheForm();\n    },\n\n    save() {\n      console.log(this.$refs.md.d_value); // var htmlCode = this.$refs.md.d_render;\n\n      var markdownCode = this.$refs.md.d_render;\n      this.submit.value_S = this.value_S;\n      this.submit.value_P = this.value_P;\n      this.submit.designee = this.designee;\n      this.submit.title = this.title;\n      this.submit.enddate = this.enddate;\n      this.submit.related_module = this.related_module;\n      this.submit.type_of_bug = this.type_of_bug;\n      this.submit.bugState = \"未确认\";\n      this.submit.bugDescription = markdownCode;\n      this.submit.corresponding_needs = this.corresponding_needs;\n      this.submit.web_browser = this.web_browser;\n      this.submit.os = this.os;\n      this.submit.creatorId = \"2020214575\";\n      this.submit.related_task = this.related_task;\n      this.postRequest(\"/bugs/insertbug\", this.submit).then(response => {\n        if (response.code == \"200\") {\n          Message.success({\n            message: response.msg\n          });\n        } else {\n          Message.error({\n            message: response.msg\n          });\n        }\n      });\n      console.log(result);\n      this.dialogFormVisible = false;\n    },\n\n    //保存图片到后台\n    imgAdd(pos, $file) {\n      var _this = this; // 第一步.将图片上传到服务器.\n\n\n      console.log(\"pos:\" + pos);\n      var formdata = new FormData();\n      formdata.append(\"img\", $file);\n      axios.post(\"http://img.codesocean.top/upload/img\", formdata, {\n        headers: {\n          ApiKey: \"n77Eu6QKFRvCVkMx7HEGWHxo1XTYdb\"\n        }\n      }) //补上后台接口即可\n      .then(response => {\n        // 请求成功\n        console.log(\"请求成功\");\n        console.log(response.url);\n        var url = response.url; //取出上传成功后的url\n\n        if (response.msg == \"success\") {\n          //  将后端返回的url放在md中图片的指定位置\n          console.log(JSON.stringify(url));\n          this.$refs.md.$img2Url(pos, url);\n        } else {\n          this.$message({\n            type: response.status,\n            message: response.statusText\n          });\n        }\n      }).catch(error => {\n        // 请求失败\n        console.log(\"请求失败\");\n        console.log(error);\n      }); //   axios(formdata).then((resp) => {\n      //     var url = resp.data; //取出上传成功后的url\n      //     if (resp.status == 200) {\n      //       //  将后端返回的url放在md中图片的指定位置\n      //       console.log(url);\n      //       _this.$refs.md.$img2Url(pos, url);\n      //     } else {\n      //       _this.$message({ type: resp.status, message: resp.statusText });\n      //     }\n      //   });\n      // },\n    } // img_file: {},\n\n\n  },\n\n  data() {\n    return {\n      related_modules: [],\n      affirmed_related_module: \"\",\n      // 控制弹窗\n      detailVisible: false,\n      content: \"\",\n      value_P: \"\",\n      value_S: \"\",\n      value: \"\",\n      submit: {\n        bugDescription: \"string\",\n        bugState: \"未确认\",\n        creatorId: \"2020214584\",\n        designee: \"string\",\n        enddate: null,\n        related_module: 0,\n        title: \"string\",\n        type_of_bug: \"string\",\n        value_P: 0,\n        value_S: 0,\n        related_task: \"string\",\n        web_browser: \"string\",\n        corresponding_needs: \"string\",\n        os: \"mac\"\n      },\n      title: \"\",\n      related_module: \"\",\n      designee: \"\",\n      corresponding_needs: \"\",\n      related_task: \"\",\n      type_of_bug: \"\",\n      endDate: \"\",\n      os: \"\",\n      web_browser: \"\",\n      priority: [{\n        value_P: 1,\n        label: \"1\"\n      }, {\n        value_P: 2,\n        label: \"2\"\n      }, {\n        value_P: 3,\n        label: \"3\"\n      }, {\n        value_P: 4,\n        label: \"4\"\n      }, {\n        value_P: 5,\n        label: \"5\"\n      }],\n      options_severity: [{\n        value_S: 1,\n        label: \"最严重\"\n      }, {\n        value_S: 2,\n        label: \"严重\"\n      }, {\n        value_S: 3,\n        label: \"一般\"\n      }, {\n        value_S: 4,\n        label: \"不重要\"\n      }],\n      toolbars: {\n        bold: true,\n        // 粗体\n        italic: true,\n        // 斜体\n        header: true,\n        // 标题\n        underline: true,\n        // 下划线\n        mark: true,\n        // 标记\n        superscript: true,\n        // 上角标\n        quote: true,\n        // 引用\n        ol: true,\n        // 有序列表\n        ink: true,\n        // 链接\n        imagelink: true,\n        // 图片链接\n        help: true,\n        // 帮助\n        code: true,\n        // code\n        subfield: true,\n        // 是否需要分栏\n        fullscreen: true,\n        // 全屏编辑\n        readmodel: true,\n        // 沉浸式阅读\n\n        /* 1.3.5 */\n        undo: true,\n        // 上一步\n        trash: true,\n        // 清空\n        save: true,\n        // 保存（触发events中的save事件）\n\n        /* 1.4.2 */\n        navigation: true // 导航目录\n\n      }\n    };\n  }\n\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHA;AACA;AACA;AACA;AAEA;EACAA,gBADA;;EAGAC;IACA;IACA;IACA;EACA,CAPA;;EASAC;IACAC;MACA;MACAC;IACA,CAJA;;IAKAC;MACA;IACA,CAPA;;IAQAC;MACAF,mCADA,CAGA;;MACA;MAEA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MAEA;QACA,4BACA;UAAAG;YAAAC;UAAA;QAAA,CADA,MAEA;UACAD;YAAAC;UAAA;QACA;MACA,CANA;MAQAJ;MACA;IACA,CAvCA;;IAyCA;IACAK;MACA,iBADA,CAEA;;;MACAL;MACA;MACAM;MAEAC,MACAC,IADA,CAEA,sCAFA,EAIAF,QAJA,EAMA;QACAG;UACAC;QADA;MADA,CANA,EAWA;MAXA,CAYAC,IAZA,CAYAC;QACA;QACAZ;QACAA;QACA,uBAJA,CAIA;;QACA;UACA;UACAA;UACA;QACA,CAJA,MAIA;UACA;YACAa,qBADA;YAEAT;UAFA;QAIA;MACA,CA3BA,EA4BAU,KA5BA,CA4BAC;QACA;QACAf;QACAA;MACA,CAhCA,EAPA,CAyCA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA,CA9FA,CAgGA;;;EAhGA,CATA;;EA2GAgB;IACA;MACAC,mBADA;MAEAC,2BAFA;MAIA;MACAC,oBALA;MAOAC,WAPA;MASAC,WATA;MAUAC,WAVA;MAWAC,SAXA;MAaAC;QACAC,wBADA;QAEAC,eAFA;QAGAC,uBAHA;QAIAC,kBAJA;QAKAC,aALA;QAMAC,iBANA;QAOAC,eAPA;QAQAC,qBARA;QASAX,UATA;QAUAC,UAVA;QAWAW,sBAXA;QAYAC,qBAZA;QAaAC,6BAbA;QAcAC;MAdA,CAbA;MA8BAL,SA9BA;MA+BAD,kBA/BA;MAgCAF,YAhCA;MAiCAO,uBAjCA;MAkCAF,gBAlCA;MAmCAD,eAnCA;MAoCAK,WApCA;MAqCAD,MArCA;MAsCAF,eAtCA;MAwCAI,WACA;QACAjB,UADA;QAEAkB;MAFA,CADA,EAKA;QACAlB,UADA;QAEAkB;MAFA,CALA,EASA;QACAlB,UADA;QAEAkB;MAFA,CATA,EAaA;QACAlB,UADA;QAEAkB;MAFA,CAbA,EAiBA;QACAlB,UADA;QAEAkB;MAFA,CAjBA,CAxCA;MA8DAC,mBACA;QACAlB,UADA;QAEAiB;MAFA,CADA,EAKA;QACAjB,UADA;QAEAiB;MAFA,CALA,EASA;QACAjB,UADA;QAEAiB;MAFA,CATA,EAaA;QACAjB,UADA;QAEAiB;MAFA,CAbA,CA9DA;MAgFAE;QACAC,UADA;QACA;QACAC,YAFA;QAEA;QACAC,YAHA;QAGA;QACAC,eAJA;QAIA;QACAC,UALA;QAKA;QACAC,iBANA;QAMA;QACAC,WAPA;QAOA;QACAC,QARA;QAQA;QACAC,SATA;QASA;QACAC,eAVA;QAUA;QACAC,UAXA;QAWA;QACAC,UAZA;QAYA;QACAC,cAbA;QAaA;QACAC,gBAdA;QAcA;QACAC,eAfA;QAeA;;QACA;QACAC,UAjBA;QAiBA;QACAC,WAlBA;QAkBA;QACAxD,UAnBA;QAmBA;;QACA;QACAyD,gBArBA,CAqBA;;MArBA;IAhFA;EAwGA;;AApNA","names":["name","created","methods","init","console","Close","save","Message","message","imgAdd","formdata","axios","post","headers","ApiKey","then","response","type","catch","error","data","related_modules","affirmed_related_module","detailVisible","content","value_P","value_S","value","submit","bugDescription","bugState","creatorId","designee","enddate","related_module","title","type_of_bug","related_task","web_browser","corresponding_needs","os","endDate","priority","label","options_severity","toolbars","bold","italic","header","underline","mark","superscript","quote","ol","ink","imagelink","help","code","subfield","fullscreen","readmodel","undo","trash","navigation"],"sourceRoot":"src/components","sources":["form.vue"],"sourcesContent":["<template>\r\n  <div id=\"form\" :visible.sync=\"detailVisible\">\r\n    <div class=\"row\">\r\n      Bug标题:<el-input\r\n        v-model=\"title\"\r\n        placeholder=\"请输入内容\"\r\n        style=\"width: 1070px\"\r\n    ></el-input>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      相关模块:<el-select\r\n        v-model=\"related_module\"\r\n        placeholder=\"请输入内容\"\r\n        style=\"width: 500px\"\r\n    >\r\n      <el-option\r\n          v-for=\"item in related_modules\"\r\n          :key=\"item.moduleId\"\r\n          :label=\"item.moduleName\"\r\n          :value=\"item.moduleId\"\r\n      >\r\n      </el-option>\r\n    </el-select>\r\n      被指派者:<el-input\r\n        v-model=\"designee\"\r\n        placeholder=\"请输入内容\"\r\n        style=\"width: 500px\"\r\n    ></el-input>\r\n    </div>\r\n    <div class=\"row\">\r\n      相关需求:<el-input\r\n        v-model=\"corresponding_needs\"\r\n        placeholder=\"请输入内容\"\r\n        style=\"width: 500px\"\r\n    ></el-input>\r\n      相关任务:<el-input\r\n        v-model=\"related_task\"\r\n        placeholder=\"请输入内容\"\r\n        style=\"width: 500px\"\r\n    ></el-input>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      Bug类型:\r\n      <el-input\r\n          v-model=\"type_of_bug\"\r\n          placeholder=\"请输入内容\"\r\n          style=\"width: 500px\"\r\n      ></el-input>\r\n      结束时间:<el-input\r\n        v-model=\"endDate\"\r\n        placeholder=\"请输入内容\"\r\n        style=\"width: 500px\"\r\n    ></el-input>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      优先级:<el-select\r\n        v-model=\"value_P\"\r\n        placeholder=\"请选择\"\r\n        @change=\"$forceUpdate()\"\r\n        style=\"width: 500px; padding-right: 15px\"\r\n    >\r\n      <el-option\r\n          v-for=\"item in priority\"\r\n          :key=\"item.value_P\"\r\n          :label=\"item.label\"\r\n          :value=\"item.value_P\"\r\n      >\r\n      </el-option>\r\n    </el-select>\r\n      严重程度:\r\n      <el-select\r\n          v-model=\"value_S\"\r\n          placeholder=\"请选择\"\r\n          @change=\"$forceUpdate()\"\r\n          style=\"width: 483px\"\r\n      >\r\n        <el-option\r\n            v-for=\"item in options_severity\"\r\n            :key=\"item.value_S\"\r\n            :label=\"item.label\"\r\n            :value=\"item.value_S\"\r\n        >\r\n        </el-option>\r\n      </el-select>\r\n    </div>\r\n\r\n    <div class=\"row\">\r\n      操作系统:<el-input\r\n        v-model=\"os\"\r\n        placeholder=\"请输入内容\"\r\n        style=\"width: 500px\"\r\n    ></el-input>\r\n      浏览器:<el-input\r\n        v-model=\"web_browser\"\r\n        placeholder=\"请输入内容\"\r\n        style=\"width: 500px\"\r\n    ></el-input>\r\n    </div>\r\n\r\n    <mavon-editor\r\n        v-model=\"content\"\r\n        ref=\"md\"\r\n        @save=\"save\"\r\n        @imgAdd=\"imgAdd\"\r\n        :toolbars=\"toolbars\"\r\n        style=\"width: 1090px\"\r\n    />\r\n    <el-row style=\"margin-left: 465px\">\r\n      <el-button type=\"primary\" plain @click=\"save()\">确定</el-button>\r\n      <el-button type=\"warning\" plain @click=\"Close\">关闭</el-button>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport { sub } from \"zrender/lib/core/vector\";\r\nimport store from \"@/store\";\r\nimport { Message } from \"element-ui\";\r\n\r\nexport default {\r\n  name: \"bug_form\",\r\n\r\n  created() {\r\n    // console.log(\"In Created Content\");\r\n    // console.log(this.priority);\r\n    this.related_modules = store.state.modules;\r\n  },\r\n\r\n  methods: {\r\n    init(data) {\r\n      this.detailVisible = true;\r\n      console.log(data);\r\n    },\r\n    Close() {\r\n      this.$parent.ClosetheForm();\r\n    },\r\n    save() {\r\n      console.log(this.$refs.md.d_value);\r\n\r\n      // var htmlCode = this.$refs.md.d_render;\r\n      var markdownCode = this.$refs.md.d_render;\r\n\r\n      this.submit.value_S = this.value_S;\r\n      this.submit.value_P = this.value_P;\r\n      this.submit.designee = this.designee;\r\n      this.submit.title = this.title;\r\n      this.submit.enddate = this.enddate;\r\n      this.submit.related_module = this.related_module;\r\n      this.submit.type_of_bug = this.type_of_bug;\r\n      this.submit.bugState = \"未确认\";\r\n      this.submit.bugDescription = markdownCode;\r\n      this.submit.corresponding_needs = this.corresponding_needs;\r\n      this.submit.web_browser = this.web_browser;\r\n      this.submit.os = this.os;\r\n      this.submit.creatorId = \"2020214575\";\r\n      this.submit.related_task = this.related_task;\r\n\r\n      this.postRequest(\"/bugs/insertbug\", this.submit).then((response) => {\r\n        if (response.code==\"200\")\r\n        {Message.success({message:response.msg});}\r\n        else {\r\n          Message.error({message:response.msg});\r\n        }\r\n      });\r\n\r\n      console.log(result);\r\n      this.dialogFormVisible = false;\r\n    },\r\n\r\n    //保存图片到后台\r\n    imgAdd(pos, $file) {\r\n      var _this = this;\r\n      // 第一步.将图片上传到服务器.\r\n      console.log(\"pos:\" + pos);\r\n      var formdata = new FormData();\r\n      formdata.append(\"img\", $file);\r\n\r\n      axios\r\n          .post(\r\n              \"http://img.codesocean.top/upload/img\",\r\n\r\n              formdata,\r\n\r\n              {\r\n                headers: {\r\n                  ApiKey: \"n77Eu6QKFRvCVkMx7HEGWHxo1XTYdb\",\r\n                },\r\n              }\r\n          ) //补上后台接口即可\r\n          .then((response) => {\r\n            // 请求成功\r\n            console.log(\"请求成功\");\r\n            console.log(response.url);\r\n            var url = response.url; //取出上传成功后的url\r\n            if (response.msg == \"success\") {\r\n              //  将后端返回的url放在md中图片的指定位置\r\n              console.log(JSON.stringify(url));\r\n              this.$refs.md.$img2Url(pos, url);\r\n            } else {\r\n              this.$message({\r\n                type: response.status,\r\n                message: response.statusText,\r\n              });\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            // 请求失败\r\n            console.log(\"请求失败\");\r\n            console.log(error);\r\n          });\r\n\r\n      //   axios(formdata).then((resp) => {\r\n      //     var url = resp.data; //取出上传成功后的url\r\n      //     if (resp.status == 200) {\r\n      //       //  将后端返回的url放在md中图片的指定位置\r\n      //       console.log(url);\r\n      //       _this.$refs.md.$img2Url(pos, url);\r\n      //     } else {\r\n      //       _this.$message({ type: resp.status, message: resp.statusText });\r\n      //     }\r\n      //   });\r\n      // },\r\n    },\r\n\r\n    // img_file: {},\r\n  },\r\n  data() {\r\n    return {\r\n      related_modules: [],\r\n      affirmed_related_module: \"\",\r\n\r\n      // 控制弹窗\r\n      detailVisible: false,\r\n\r\n      content: \"\",\r\n\r\n      value_P: \"\",\r\n      value_S: \"\",\r\n      value: \"\",\r\n\r\n      submit: {\r\n        bugDescription: \"string\",\r\n        bugState: \"未确认\",\r\n        creatorId: \"2020214584\",\r\n        designee: \"string\",\r\n        enddate: null,\r\n        related_module: 0,\r\n        title: \"string\",\r\n        type_of_bug: \"string\",\r\n        value_P: 0,\r\n        value_S: 0,\r\n        related_task: \"string\",\r\n        web_browser: \"string\",\r\n        corresponding_needs: \"string\",\r\n        os: \"mac\",\r\n      },\r\n\r\n      title: \"\",\r\n      related_module: \"\",\r\n      designee: \"\",\r\n      corresponding_needs: \"\",\r\n      related_task: \"\",\r\n      type_of_bug: \"\",\r\n      endDate: \"\",\r\n      os: \"\",\r\n      web_browser: \"\",\r\n\r\n      priority: [\r\n        {\r\n          value_P: 1,\r\n          label: \"1\",\r\n        },\r\n        {\r\n          value_P: 2,\r\n          label: \"2\",\r\n        },\r\n        {\r\n          value_P: 3,\r\n          label: \"3\",\r\n        },\r\n        {\r\n          value_P: 4,\r\n          label: \"4\",\r\n        },\r\n        {\r\n          value_P: 5,\r\n          label: \"5\",\r\n        },\r\n      ],\r\n      options_severity: [\r\n        {\r\n          value_S: 1,\r\n          label: \"最严重\",\r\n        },\r\n        {\r\n          value_S: 2,\r\n          label: \"严重\",\r\n        },\r\n        {\r\n          value_S: 3,\r\n          label: \"一般\",\r\n        },\r\n        {\r\n          value_S: 4,\r\n          label: \"不重要\",\r\n        },\r\n      ],\r\n      toolbars: {\r\n        bold: true, // 粗体\r\n        italic: true, // 斜体\r\n        header: true, // 标题\r\n        underline: true, // 下划线\r\n        mark: true, // 标记\r\n        superscript: true, // 上角标\r\n        quote: true, // 引用\r\n        ol: true, // 有序列表\r\n        ink: true, // 链接\r\n        imagelink: true, // 图片链接\r\n        help: true, // 帮助\r\n        code: true, // code\r\n        subfield: true, // 是否需要分栏\r\n        fullscreen: true, // 全屏编辑\r\n        readmodel: true, // 沉浸式阅读\r\n        /* 1.3.5 */\r\n        undo: true, // 上一步\r\n        trash: true, // 清空\r\n        save: true, // 保存（触发events中的save事件）\r\n        /* 1.4.2 */\r\n        navigation: true, // 导航目录\r\n      },\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n#form {\r\n  display: flex;\r\n  flex-direction: column;\r\n  width: 100%;\r\n  left: 0%;\r\n}\r\n.row {\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: center;\r\n  width: 1160px;\r\n  /* justify-content: space-between; */\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}